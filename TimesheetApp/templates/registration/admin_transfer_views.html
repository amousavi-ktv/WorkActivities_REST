
{% extends "base.html" %}
{% block content %}
<h1>Export DB Views to Google Sheets</h1>

{% for message in messages %}
<div class="msg {{ message.tags }}">{{ message }}</div>
{% endfor %}

<table>
    <thead>
        <tr><th>View Name</th><th>Google Sheets ID</th><th>Description</th><th></th></tr>
    </thead>
    <tbody>
        {% for v in views %}
        <tr>
            <td>{{ v.view_name }}</td>
            <td>{{ v.google_sheets_id }}</td>
            <td>{{ v.description }}</td>
            <td>
                <form method="post" action="{% url 'timesheet:admin_export_view_to_gsheet' %}">
                    {% csrf_token %}
                    <input type="hidden" name="view_name" value="{{ v.view_name }}">
                    <input type="hidden" name="google_sheets_id" value="{{ v.google_sheets_id }}">
                    <button type="submit">Export</button>
                </form>
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="4">No views configured.</td></tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
